<!DOCTYPE html><!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]--><!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]--><!--[if gt IE 8]><!--><html class=no-js><!--<![endif]--><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Testing double-click events using Geb</title><!-- facebook open graph tags --><meta property=og:type content=article><meta property=og:site_name content="Ryan Brooks' blog"><meta property=og:url content="https://www.ryanbrooks.co.uk/posts/2014-02-06-geb-doubleclick/"><meta property=og:title content="Testing double-click events using Geb"><meta property=og:description content=""><!-- twitter card tags additive with the og: tags --><meta name=twitter:card content=summary><meta name=twitter:site content=@spikeheap><meta name=twitter:url value="https://www.ryanbrooks.co.uk/posts/2014-02-06-geb-doubleclick/"><meta name=twitter:title value="Testing double-click events using Geb"><meta name=twitter:description value=""><meta name=twitter:label1 value="Reading time"><meta name=twitter:data1 value="üïí 2 minutes"><meta name=viewport content="width=device-width, initial-scale=1"><link rel=alternate type=application/rss+xml title="Ryan Brooks' blog" href=https://www.ryanbrooks.co.uk/feed.xml><link rel=stylesheet href=/css/style.6c78.css><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='//www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-43110335-1');ga('send','pageview');</script><meta name=google-site-verification content=Ie2d0Oy5dhnMbWcw7qg7PIeq3Wiv9X7GoyyL9pz39Eo></head><body><!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]--><nav class="navbar navbar-default navbar-top"><div class=container><!-- Brand and toggle get grouped for better mobile display --><div class=navbar-header><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#bs-example-navbar-collapse-1><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=navbar-brand href="/">Ryan Brooks</a></div><!-- Collect the nav links, forms, and other content for toggling --><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav"><li><a href=/archives.html>Blog archive</a></li></ul><ul class="nav navbar-nav navbar-right"><li><a class="nav-fa-link target=" _blank="" href=https://github.com/spikeheap><i class="fa fa-2x fa-github-square"></i></a></li><li><a class="nav-fa-link target=" _blank="" href=https://twitter.com/spikeheap><i class="fa fa-2x fa-twitter-square"></i></a></li><li><a class="nav-fa-link target=" _blank="" href=http://uk.linkedin.com/in/ryanpbrooks><i class="fa fa-2x fa-linkedin-square"></i></a></li><li><a class="nav-fa-link target=" _blank="" href=mailto:ryanbrooksis+info@gmail.com><i class="fa fa-2x fa-envelope-square"></i></a></li></ul></div><!-- /.navbar-collapse --></div></nav><div class=container><div class=row><div class=col-sm-9><h1 class=page-title>Testing double-click events using Geb</h1><span class=text-muted>06 Feb 2014</span>, <span class="reading-time text-muted">1 minute read</span><p></p><p>Testing basic interaction with Geb is easy, but the ‚Äòintuitive‚Äô way of doing double-clicks fails silently and without any real indication as to why. Fortunately there‚Äôs a simple solution! <!-- more --></p><p>My first approach was to use <code>dblClick()</code> in place of <code>click()</code>. The result was a test which compiled and ran, but failed to generate the double click event:</p><noscript><pre>import geb.spock.GebReportingSpec

class failingSpec extends GebReportingSpec {
    def &quot;double clicking highlights the second div&quot;(){
        def elementIwant = $(&#39;div&#39;, text: &#39;Double-clickable div&#39;)
        
        when: &quot;I click an element&quot;
        elementIwant.click() // Works
        
        then: &quot;a div has the activated class applied to it&quot;
        $(&#39;div&#39;, text: &#39;single-clicked&#39;).hasClass(&quot;activated&quot;)
        
        when: &quot;I double-click an element&quot;
        elementIwant.dblClick() // Does nothing
        
        then: &quot;a different div has the activated class applied to it&quot;
        $(&#39;div&#39;, text: &#39;double-clicked&#39;).hasClass(&quot;activated&quot;) // assertion fails
        
    }
}</pre></noscript><script src="https://gist.github.com/spikeheap/8845429.js?file=failingSpec.groovy"></script><p>It turns out that double-clicking is a ‚Äúcomplex interaction‚Äù, and because it isn‚Äôt used that much on webpages it‚Äôs not part of the core functionality of NonEmptyNavigator.</p><p>Fortunately building complex interactions is trivial in Geb, so my updated Spock test only needs one line replacing:</p><noscript><pre>import geb.spock.GebReportingSpec

class passingSpec extends GebReportingSpec {
    def &quot;double clicking highlights the second div&quot;(){
        def elementIwant = $(&#39;div&#39;, text: &#39;Double-clickable div&#39;)
        
        when: &quot;I click an element&quot;
        elementIwant.click() // Works
        
        then: &quot;a div has the activated class applied to it&quot;
        $(&#39;div&#39;, text: &#39;single-clicked&#39;).hasClass(&quot;activated&quot;)
        
        when: &quot;I double-click an element&quot;
        interact { doubleClick(elementIwant) }
        
        then: &quot;a different div has the activated class applied to it&quot;
        $(&#39;div&#39;, text: &#39;double-clicked&#39;).hasClass(&quot;activated&quot;) // assertion passes
        
    }
}</pre></noscript><script src="https://gist.github.com/spikeheap/8845429.js?file=passingSpec.groovy"></script><p>Great, on to the next test!</p><h3 id=update-722014>Update (7/2/2014)</h3><p>Here‚Äôs another example, this time using interactions to do a context-click (right-click to you an me!):</p><noscript><pre>// place in src/test/groovy/
import geb.Browser

import geb.*
import org.openqa.selenium.firefox.FirefoxDriver
import geb.spock.GebSpec

class contextClickerSpec extends GebSpec{

  def &quot;Context click opens menu&quot;(){
     
    setup:
    go &quot;http://medialize.github.io/jQuery-contextMenu/demo.html&quot;
    def contextBox = $(&quot;.context-menu-one&quot;)
    contextBox.text() == &quot;right click me&quot;
  
    when: &quot;I context-click the div&quot;
    interact{ contextClick(contextBox) }
    def editOption = $(&#39;li.context-menu-item:nth-child(1) &gt; span:nth-child(1)&#39;)
    
    then: &quot;It displays the edit option&quot;
    editOption.displayed
    editOption.text() == &quot;Edit&quot;
    
    cleanup:
    quit()
  }
}</pre></noscript><script src="https://gist.github.com/spikeheap/8862048.js?file=contextClickerSpec.groovy"></script><p>If you want to run the test, the following gradle script will sort you out:</p><noscript><pre>apply plugin: &#39;groovy&#39;

repositories{
  mavenCentral()
}

dependencies{
  compile &#39;org.codehaus.groovy:groovy-all:2.2.1&#39;
  compile &quot;org.gebish:geb-core:0.9.2&quot;, &quot;org.gebish:geb-spock:0.9.2&quot;, &quot;org.seleniumhq.selenium:selenium-firefox-driver:2.39.0&quot;, &quot;org.seleniumhq.selenium:selenium-support:2.39.0&quot;
  testCompile &quot;org.spockframework:spock-core:0.7-groovy-2.0&quot;
}

task runScript (dependsOn: &#39;classes&#39;, type: JavaExec) {
  main = &#39;contextClicker&#39;
  classpath = sourceSets.main.runtimeClasspath
}
</pre></noscript><script src="https://gist.github.com/spikeheap/8862048.js?file=build.gradle"></script><hr><div class=discussion><h1>Discuss!</h1><p>Was this post useful? Why not help others find it by sharing on <a href="https://twitter.com/intent/user?screen_name=spikeheap" target=_blank><i class="fa fa-twitter"></i> twitter</a>. While you're there, get in touch and let me know what you think!</p></div><div class=post-nav><a class="hidden-xs btn btn-sm btn-default pull-left half-width-max text-overflow" href="/posts/2014-01-23-bower-dependencies-with-gradle/"><i class="fa fa-arrow-circle-left"></i> Bower dependencies with Gradle</a> <a class="visible-xs-block btn btn-default btn-block text-overflow" href="/posts/2014-01-23-bower-dependencies-with-gradle/"><i class="fa fa-fw fa-arrow-circle-left"></i> Bower dependencies with Gradle</a> <a class="btn btn-sm btn-default hidden-xs pull-right half-width-max text-overflow" href="/posts/2014-02-22-open-data-day-2014/">Open Data Day 2014 <i class="fa fa-arrow-circle-right"></i></a> <a class="visible-xs-block btn btn-default btn-block text-overflow" href="/posts/2014-02-22-open-data-day-2014/"><i class="fa fa-fw fa-arrow-circle-right"></i> Open Data Day 2014</a> <span class=clearfix></span></div></div><div class="col-sm-3 border-left"><div class=bio><img src=/images/profile-400px.d912.jpg><h3>Hi, I'm Ryan</h3><p>I care about code, building great teams and the community. I run <a href=https://www.slatehorse.com>Slate Horse</a> but I'm still a full-stack developer. Previously co-organiser of <a href="http://jsoxford.com/">JSOxford</a> and <a href="http://oxrug.org/">OxRUG</a>.</p><hr><h4>Get in touch</h4><div class=contact-icons><a target=_blank href=https://twitter.com/spikeheap><i class="fa fa-2x fa-twitter-square"></i></a> <a target=_blank href=https://github.com/spikeheap><i class="fa fa-2x fa-github-square"></i></a> <a target=_blank href=http://uk.linkedin.com/in/ryanpbrooks><i class="fa fa-2x fa-linkedin-square"></i></a> <a target=_blank href=mailto:ryanbrooksis+info@gmail.com><i class="fa fa-2x fa-envelope-square"></i></a></div></div></div></div></div><footer class="container-fluid footer--bottom"><div class=container><small>&copy; Ryan Brooks. The content of this page is licensed under the Creative Commons Attribution 3.0 License.</small></div></footer><script src=/vendor/node_modules/jquery/dist/jquery.min.js></script><script src=/vendor/node_modules/bootstrap-sass/assets/javascripts/bootstrap.js></script></body></html>
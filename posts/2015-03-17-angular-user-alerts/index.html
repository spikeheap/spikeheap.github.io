

<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>App-wide AngularJS alerts</title>
        

        
          <!-- facebook open graph tags -->
          <meta property="og:type" content="article" />
          <meta property="og:site_name" content="Ryan Brooks' blog">
          <meta property="og:url" content="https://www.ryanbrooks.co.uk/posts/2015-03-17-angular-user-alerts/" />
          <meta property="og:title" content="App-wide AngularJS alerts" />
          <meta property="og:description" content="" />

          <!-- twitter card tags additive with the og: tags -->
          <meta name="twitter:card" content="summary">
          <meta name="twitter:site" content="@spikeheap" />
          <meta name="twitter:url" value="https://www.ryanbrooks.co.uk/posts/2015-03-17-angular-user-alerts/" />
          <meta name="twitter:title" value="App-wide AngularJS alerts" />
          <meta name="twitter:description" value="" />
          <meta name="twitter:label1" value="Reading time" />
          <meta name="twitter:data1" value="ðŸ•’ 3 minutes" />
        
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="alternate" type="application/rss+xml" title="Ryan Brooks' blog" href="https://www.ryanbrooks.co.uk/feed.xml">
        <!-- build:css /css/style.css -->
        <link rel="stylesheet" href="/css/style.css">
        <!-- endbuild -->
        <script>
            (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='//www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-43110335-1');ga('send','pageview');
        </script>
        <meta name="google-site-verification" content="Ie2d0Oy5dhnMbWcw7qg7PIeq3Wiv9X7GoyyL9pz39Eo" />
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <nav class="navbar navbar-default navbar-top">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Ryan Brooks</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        
        
          
            <li><a href="/archives/">Blog archive</a></li>
          
        
      </ul>

      <ul class="nav navbar-nav navbar-right">
        <li><a class="nav-fa-link target="_blank" href="https://github.com/spikeheap"><i class="fa fa-2x fa-github-square"></i></a></li>
    		<li><a class="nav-fa-link target="_blank" href="https://twitter.com/spikeheap"><i class="fa fa-2x fa-twitter-square"></i></a></li>
    		<li><a class="nav-fa-link target="_blank" href="http://uk.linkedin.com/in/ryanpbrooks"><i class="fa fa-2x fa-linkedin-square"></i></a></li>
    		<li><a class="nav-fa-link target="_blank" href="mailto:ryanbrooksis+info@gmail.com"><i class="fa fa-2x fa-envelope-square"></i></a></li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div>
</nav>


        <div class="container">
  <div class="row">
      <div class="col-sm-9">
          <h1 class="page-title">App-wide AngularJS alerts</h1>
          <span class="text-muted">17 Mar 2015</span>, <span class="reading-time text-muted">2 minute read</span>
          <p></p>
          <p>Generic alerts are a common requirement in most web applications, and as your Angular application grows in complexity the importance of a standardised way of feeding back to the user gains importance with it. Luckily itâ€™s quite straightforward to leverage Angular services as a system-wide alerting tool.</p>

<!-- more -->

<p>There are a number of articles covering Angular user alerting, but each one relied on <code class="language-plaintext highlighter-rouge">$rootScope</code> or nested scopes. I try to avoid use of the root scope where possible, in the same way we shun the use of the global namespace in JavaScript in general.</p>

<p>Th first problem we need to solve is to collect and manage the list of alerts. to do this we can create a very simple Angular service:</p>

<noscript><pre>; (function (angular) {
  &#39;use strict&#39;;
  angular
    .module(&#39;pageAlerts&#39;)
    .factory(&#39;PageAlertsService&#39;, [ &#39;$timeout&#39;, function($timeout) {

      // Private functions and internal state
      var internal = {

        alerts: [],

        addAlert: function(type, message, autoClose) {
          var newAlert = {
            type: type,
            message: message,
            close: function() { internal.removeAlert(this) }
          };
          internal.alerts.push( newAlert );
          if(autoClose){
            $timeout(function() { newAlert.close() }, 5000)
          }
        },

        removeAlert: function(alert) {
          internal.alerts.splice( internal.alerts.indexOf(alert), 1);
        }
      };

      // Return the public API for the service
      // We&#39;ll expose the `alerts` array for convenience
      return {
        addError: function(message, autoClose) {
          internal.addAlert(&#39;danger&#39;, message, autoClose);
        },
        addWarning: function(message, autoClose) {
          internal.addAlert(&#39;warning&#39;, message, autoClose);
        },
        addSuccess: function(message, autoClose) {
          internal.addAlert(&#39;success&#39;, message, autoClose);
        },

        alerts: internal.alerts
      };
    } ])
})(window.angular);
</pre></noscript>
<script src="https://gist.github.com/spikeheap/9709d80f14bf63050d6c.js?file=PageAlertsService.js"> </script>

<p>We can then create a directive to interact with the service:</p>

<noscript><pre>; (function (angular) {
  &#39;use strict&#39;;
  angular
    .module(&#39;pageAlerts&#39;)
    .directive(&#39;pageAlerts&#39;, [&#39;PageAlertsService&#39;, function(PageAlertsService) {
      return {
        templateUrl: &#39;/directives/PageAlerts/PageAlerts.html&#39;,
        replace: true,
        link: function (scope) {
          scope.alerts = PageAlertsService.alerts;
        }
      }
    }]);
}(window.angular));
</pre></noscript>
<script src="https://gist.github.com/spikeheap/9709d80f14bf63050d6c.js?file=PageAlerts.js"> </script>

<noscript><pre>&lt;div&gt;
  &lt;alert ng-repeat=&quot;alert in alerts&quot; type=&quot;{{alert.type}}&quot; close=&quot;alert.close()&quot;&gt;{{alert.message}}&lt;/alert&gt;
&lt;/div&gt;
</pre></noscript>
<script src="https://gist.github.com/spikeheap/9709d80f14bf63050d6c.js?file=PageAlerts.html"> </script>

<p>The above example uses <a href="TODO">Angular Bootstrap</a> alerts, but you can obviously roll your own within the directive.</p>

<p>To add the alerts to your page all you need is <code class="language-plaintext highlighter-rouge">&lt;my-page-alerts&gt;&lt;/my-page-alerts&gt;</code>.</p>

<p>The service/directive pair results in a globally accessible alerting service without the need to pollute the <code class="language-plaintext highlighter-rouge">$rootScope</code>. One criticism of this approach is that the service and directive are tightly coupled, but this can be remedied by passing in the service as an attribute to the directive, an exercise Iâ€™ll leave to the reader (but grab me in the comments or <a href="https://twitter.com/spikeheap">on Twitter</a> if you want a hand ;) ).</p>

          <hr>

          <div class="discussion">
<h1>Discuss!</h1>
<p>
  Was this post useful? Why not help others find it by sharing on <a href="https://twitter.com/intent/user?screen_name=spikeheap" target="_blank"><i class="fa fa-twitter"></i> twitter</a>. While you're there, get in touch and let me know what you think!
</p>
</div>

          <div class="post-nav">

    <a class="hidden-xs btn btn-sm btn-default pull-left half-width-max text-overflow" href="/posts/2014-09-27-give-and-tell/"><i class="fa fa-arrow-circle-left"></i> Give and tell challenge</a>
    <a class="visible-xs-block btn btn-default btn-block text-overflow" href="/posts/2014-09-27-give-and-tell/"><i class="fa fa-fw fa-arrow-circle-left"></i> Give and tell challenge</a>




    <a class="btn btn-sm btn-default hidden-xs pull-right half-width-max text-overflow" href="/posts/2015-03-22-reclaiming-my-saturday-mornings/">Reclaiming my Saturday mornings <i class="fa fa-arrow-circle-right"></i></a>
    <a class="visible-xs-block btn btn-default btn-block text-overflow" href="/posts/2015-03-22-reclaiming-my-saturday-mornings/"><i class="fa fa-fw fa-arrow-circle-right"></i> Reclaiming my Saturday mornings</a>

<span class="clearfix">
</span>
</div>



      </div>
      <div class="col-sm-3 border-left">
        <div class="bio">
  <img src="/images/profile-400px.jpg">
  <h3>Hi, I'm Ryan</h3>
  <p>
      I care about code, building great teams and the community. I run <a href="https://www.slatehorse.com">Slate Horse</a> but I'm still a full-stack developer. Previously co-organiser of <a href="http://jsoxford.com/">JSOxford</a> and <a href="http://oxrug.org/">OxRUG</a>.
  </p>

  <hr>

  <h4>Get in touch</h4>

  <div class="contact-icons">
	<a target="_blank" href="https://twitter.com/spikeheap"><i class="fa fa-2x fa-twitter-square"></i></a>
  <a target="_blank" href="https://github.com/spikeheap"><i class="fa fa-2x fa-github-square"></i></a>
	<a target="_blank" href="http://uk.linkedin.com/in/ryanpbrooks"><i class="fa fa-2x fa-linkedin-square"></i></a>
	<a target="_blank" href="mailto:ryanbrooksis+info@gmail.com"><i class="fa fa-2x fa-envelope-square"></i></a>
</div>

</div>

      </div>
  </div>
</div>


        <footer class="container-fluid footer--bottom">
	<div class="container">
		<small>
			&copy; Ryan Brooks. The content of this page is licensed under the Creative Commons Attribution 3.0 License.
		</small>
	</div>
</footer>


        <script src="/vendor/node_modules/jquery/dist/jquery.min.js"></script>
        <script src="/vendor/node_modules/bootstrap-sass/assets/javascripts/bootstrap.js"></script>
    </body>
</html>
